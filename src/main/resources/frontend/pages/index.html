<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="/style/styles.css">
    <link rel="stylesheet" href="/style/root.css">
    <link rel="stylesheet" href="/style/presets/preset.css">
    <link rel="stylesheet" href="/style/presets/alert.css">
    <link rel="stylesheet" href="/style/presets/ctxmenu.css">
    <link rel="stylesheet" href="/style/presets/tab.css">
    <link rel="stylesheet" href="/style/presets/circleProgress.css">

    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.7.2/css/all.css">
</head>
<body class="radial-background-1 m-0 h-100 w-100 p-2 size-borderbox d-flex">
    <!--Nav menu-->
    <div class="m-r-2 d-flex w-13 flex-column">
        <!--Logo container-->
        <div class="w-100p container-1 m-b-2 h-7p d-flex align-center justify-center" onclick="window.location = '/'">
            <h1 class="m-0">Storage</h1>
        </div>

        <!--Nav items-->
        <nav class="w-100p flex-1 container-1 flex-column d-flex p-1">
            <a class="button-1 w-100p size-borderbox p-l-1 m-b-1" href="#drive" onclick="refreshDirectoryDrive()" type="tab"><i class="fa-solid fa-hard-drive m-r-08"></i>My Drive</a>
            <a class="button-1 w-100p size-borderbox p-l-1 m-b-1" href="#starred" onclick="refreshDirectoryStarred()" type="tab"><i class="fa-regular fa-star m-r-08"></i>My Starred</a>


            <div class="m-t-2 w-100p m-b-1 b-round h-06" style="background-color: white">
                <div class="b-round h-06" id="storageLimitFill"></div>
            </div>
            <span class="m-b-2 font-small" id="storageLimitText">loading. of loading. used</span>

            <!--Nav Bottom-->
            <div class="m-t-a w-100p d-flex flex-column">
                <!--Seperator-->
                <span class="w-100p b-w-01 b-c-secondary b-s-b"></span>
                <a class="button-2 w-100p size-borderbox p-l-1 m-t-2" href="/logout"><i class="fa-regular fa-arrow-right-from-bracket m-r-08"></i>Logout</a>
            </div>
        </nav>
    </div>

    <!--Modal template-->
    <!--<div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1"></div>
        <div class="container-1 w-30 h-fit m-a">
            
        </div>
    </div>-->

    <!--Context menu-->

    <div class="p-fixed d-none flex-column p-1 font-small font-s-bold b-r-2 main-border main-bg-dark-color ctx-index" id="ctx-menu">
        <span class="button-1-accent" onclick="openFileUploadMenu(); closeContextMenu()"><i class="fa-solid fa-file-arrow-up m-r-08"></i>Upload files</span>
        <span class="m-b-1 button-1-accent" onclick="openFolderUploadMenu(); closeContextMenu()"><i class="fa-solid fa-folder-arrow-up m-r-08"></i>Upload folder</span>

        <!--Separator-->
        <span class="w-100p b-s-b b-w-01 b-c-secondary"></span>

        <span class="m-t-1 button-1-accent" onclick="openFolderModal(); closeContextMenu()"><i class="fa-solid fa-folder-plus m-r-08"></i>New folder</span>
        <span class="button-1-accent" onclick="refreshDirectoryDrive(); closeContextMenu()"><i class="fa-regular fa-arrows-rotate m-r-08"></i>Refresh</span>
    </div>

    <!--Tool tip-->
    <div class="w-fit d-none p-fixed main-bg-dark-color p-1 font-extra-small b-r-2 main-border tooltip-index" id="tooltip">example tooltip</div>

    
    <main class="flex-1 h-100p">
        <section class="w-100p h-100p d-flex flex-column" id="drive">
            <input type="file" class="d-none" id="hiddenFileInput" multiple>
            <input type="file" class="d-none" id="hiddenFolderInput" webkitdirectory>

            <!--Header-->
            <div class="w-100p container-1 m-b-2 h-7p d-flex align-center">

                <!--Search bar-->
                <div class="input-field-1 m-l-1 w-40p">
                    <i class="fa-regular fa-magnifying-glass"></i>
                    <input type="text" class="selectable" placeholder="Search" id="searchInput">
                </div>
                
                <!--Header icons-->
                <i class="fa-regular fa-bell m-l-a m-r-2 small-icon small" tooltip="Notifications"></i>
                <i class="fa-light fa-gear m-r-2 small-icon small" onclick="location.href = '/setting#account'" tooltip="Settings"></i>
                <i sec:authorize="hasRole('ADMIN')" class="fa-light fa-user-crown m-r-2 small-icon small" onclick="location.href = '/admin#user'" tooltip="Admin Panel"></i>
            </div>

            <!--Main-->
            <div class="w-100p flex-1 container-1 d-flex flex-column p-2 overflow-h">

                <!--Path view-->
                <div class="d-flex h-fit">
                    <!--Path head-->
                    <span class="small-icon b-r-2 p-1 h-fit size-borderbox font-s-bold" type="span.homePathDrive" onclick="resetDirectoryDrive()">My Drive</span>

                    <!--Path Container-->
                    <div class="d-flex h-fit" id="pathContainerDrive">

                    </div>
                </div>

                <!--Files view-->
                <div class="flex-1 size-borderbox font-thick overflow-h d-flex flex-column" id="drop-zone">
                    <!--Files head-->
                    <div class="b-s-b b-c-secondary b-w-01 d-grid grid-2-105-2-1-2 p-06 align-center">
                        <span>Name</span>
                        <span>Owner</span>
                        <span>Last modified</span>
                        <span>File Size</span>
                    </div>

                    <!--Files container-->
                    <div class="overflow-y-s flex-1" id="viewContainerDrive">
                        
                    </div>
                </div>
            </div>
        </section>

        <section class="w-100p h-100p d-flex flex-column" id="starred">
            <!--Header-->
            <div class="w-100p container-1 m-b-2 h-7p d-flex align-center">

                <!--Search bar-->
                <div class="input-field-1 m-l-1 w-40p">
                    <i class="fa-regular fa-magnifying-glass"></i>
                    <input type="text" class="selectable" placeholder="Search" id="searchInputStar">
                </div>
                
                <!--Header icons-->
                <i class="fa-regular fa-bell m-l-a m-r-2 small-icon small" tooltip="Notifications"></i>
                <i class="fa-light fa-gear m-r-2 small-icon small" onclick="location.href = '/setting#account'" tooltip="Settings"></i>
                <i sec:authorize="hasRole('ADMIN')" class="fa-light fa-user-crown m-r-2 small-icon small" onclick="location.href = '/admin#user'" tooltip="Admin Panel"></i>
            </div>

            <!--Main-->
            <div class="w-100p flex-1 container-1 d-flex flex-column p-2 overflow-h">

                <!--Path view-->
                <div class="d-flex h-fit">
                    <!--Path head-->
                    <span class="small-icon b-r-2 p-1 h-fit size-borderbox font-s-bold" path="folder-uuid">Starred</span>
                </div>

                <!--Files view-->
                <div class="flex-1 size-borderbox font-thick overflow-hd-flex flex-column">
                    <!--Files head-->
                    <div class="b-s-b b-c-secondary b-w-01 d-grid grid-2-105-2-1-2 p-06 align-center">
                        <span>Name</span>
                        <span>Owner</span>
                        <span>Last modified</span>
                        <span>File Size</span>
                    </div>

                    <!--Files container-->
                    <div class="overflow-y-s flex-1" id="viewContainerStarred">

                    </div>
                </div>
            </div>
        </section>
    </main>
    <div class="d-none p-absolute container-2 overflow-h h-fit m-2vh-6vh w-18p right-0 bottom-0 modal-upload" style="border-bottom-left-radius: 0; border-bottom-right-radius: 0;">
        <div class="d-flex align-center" style="background-color: rgb(29, 29, 29);">
            <h3 class="m-b-2 m-t-2 m-l-1 font-small" type="span.title">Uploading x item</h3>
            <i class="fa-solid fa-x font-small hover-1 m-l-a m-r-2" onclick="this.parentElement.parentElement.classList.add('d-none')"></i>
        </div>

        <div class="h-fit" type="container.upload">
            
        </div>
    </div>
</body>


<template id="file-view">
    <div class="b-s-b b-c-secondary b-w-01 d-grid grid-2-105-2-1-2 p-06 align-center hover-1">
        <span class="text-overflow-h p-l-1 m-r-2" type="span.name"><i class="fa-solid fa-file icon m-r-08" style="color: #a5a5a5;"></i>document.docx</span>
        <span class="text-overflow-h" type="span.username"></span>
        <span class="text-overflow-h" type="span.date"></span>
        <span class="text-overflow-h" type="span.size"></span>
        <div class="m-l-a d-flex">
            <i class="fa-light fa-user-plus m-r-08 small-icon small" tooltip="Share" type="icon.share"></i>
            <i class="fa-light fa-down-to-bracket m-r-08 small-icon small" tooltip="Download" type="icon.download"></i>
            <i class="fa-light fa-pen-line m-r-08 small-icon small" tooltip="Rename" type="icon.rename"></i>
            <i class="fa-regular fa-star m-r-08 small-icon small" tooltip="Favorite" type="icon.favorite"></i>
            <i class="fa-light fa-trash m-r-08 small-icon small" tooltip="Delete" type="icon.delete"></i>
        </div>
    </div>
</template>

<template id="path-view">
    <div class="d-flex align-center">
        <i class="fa-solid fa-caret-right m-r-08 m-l-08"></i>
        <span class="small-icon b-r-2 p-1 h-fit size-borderbox font-s-bold" type="span.name">My Drive</span>
    </div>
</template>

<template id="item-drag">
    <div class="container-2 h-fit w-fit p-absolute p-06 b-r-1">
        <span class="text-overflow-h p-l-1 m-r-2 font-small" type="span.name"><i class="fa-solid fa-file icon m-r-08" style="color: #a5a5a5;"></i>document.docx</span>
    </div>
</template>
<!--Trash modal-->
<template id="trashModal">
    <div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1" type="modal.background"></div>
        <div class="container-1 w-30 h-fit m-a p-2">
            <h3 class="p-0 m-0 m-b-1">Delete permanently?</h3>
            <span class="font-note font-small">Deleted items cannot be recovered.</span>
            <div class="container-2 m-t-2 p-2">
                <div class="d-flex">         <span class="font-note font-small">Name</span>             <span class="m-l-a font-small text-overflow-h w-60p text-a-r" type="span.name">Name</span>           </div>
                <div class="d-flex m-t-2">   <span class="font-note font-small">Size</span>             <span class="m-l-a font-small" type="span.size">999.99 GB</span>           </div>
                <div class="d-flex m-t-2">   <span class="font-note font-small">Last modified</span>    <span class="m-l-a font-small" type="span.date">29 Sep, 2025</span>           </div>
            </div>
            <div class="d-flex m-t-2">
                <span class="m-l-a button-2 p-lr-3" type="button.cancel">Cancel</span>
                <span class="m-l-1 button-3 p-lr-3" type="button.confirm">Delete</span>
            </div>

        </div>
    </div>
</template>

<!--Rename modal-->
<template id="renameModal">
    <div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1" type="modal.background"></div>
        <div class="container-1 w-30 h-fit m-a p-2 d-flex flex-column">
            <h3 class="p-0 m-0 m-b-1">Rename</h3>
            <span class="font-note font-small">Choose a new name for this item.</span>

            <span class="m-t-2 font-small font-note">New name</span>
            <div class="input-field-1 w-100p m-t-1">
                <input type="text" class="selectable" placeholder="New name" typeI="input.name">
            </div>

            <div class="d-flex m-t-2">
                <span class="m-l-a button-2 p-lr-3" type="button.cancel">Cancel</span>
                <span class="m-l-1 button-4 p-lr-3" type="button.confirm">Save</span>
            </div>

        </div>
    </div>
</template>

<!--Share modal-->
<template id="shareModal">
    <div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1" type="modal.background"></div>
        <div class="container-1 w-30 h-fit m-a p-2 d-flex flex-column">
            <h3 class="p-0 m-0 m-b-1">Share</h3>
            <span class="font-note font-small">Choose settings for share link.</span>

            <span class="m-t-2 font-small font-note">Download limit</span>
            <div class="input-field-1 w-100p m-t-1">
                <input type="number" class="selectable" placeholder="Limit" typeI="input.limit">
            </div>

            <!--<span class="m-t-2 font-small font-note">Expire Date</span>
            <div class="input-field-1 w-100p m-t-1">
                <i class=""></i>
                <input type="number" class="selectable" placeholder="Limit">
            </div> TODO-->

            <div class="d-flex m-t-2">
                <span class="m-l-a button-2 p-lr-3" type="button.cancel">Cancel</span>
                <span class="m-l-1 button-4 p-lr-3" type="button.confirm">Create</span>
            </div>

        </div>
    </div>
</template>

<!--Share copy modal-->
<template id="shareCopyModal">
    <div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1" type="modal.background"></div>
        <div class="container-1 w-30 h-fit m-a p-2 d-flex flex-column">
            <h3 class="p-0 m-0 m-b-1">Share</h3>
            <span class="font-note font-small">Share your download link.</span>

            <span class="m-t-2 font-small font-note">Download link</span>
            <span class="m-t-1 font-small m-b-2 selectable" type="span.link"></span>

            <div class="d-flex m-t-2">
                <span class="m-l-a button-2 p-lr-3" type="button.cancel">Close</span>
                <span class="m-l-1 button-4 p-lr-3" type="button.confirm">Copy</span>
            </div>

        </div>
    </div>
</template>

<!--Folder modal-->
<template id="folderModal">
    <div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1" type="modal.background"></div>
        <div class="container-1 w-30 h-fit m-a p-2 d-flex flex-column">
            <h3 class="p-0 m-0 m-b-1">Create new folder</h3>
            <span class="font-note font-small">Choose a name for your new folder</span>

            <span class="m-t-2 font-small font-note">name</span>
            <div class="input-field-1 w-100p m-t-1">
                <input type="text" class="selectable" placeholder="New folder" typeI="input.name">
            </div>

            <div class="d-flex m-t-2">
                <span class="m-l-a button-2 p-lr-3" type="button.cancel">Cancel</span>
                <span class="m-l-1 button-4 p-lr-3" type="button.confirm">Create</span>
            </div>

        </div>
    </div>
</template>

<template id="uploadItem">
    <div class="d-flex align-center m-t-1 m-b-1">
        <div class="d-flex align-center w-50p">
            <span class="text-overflow-h p-l-1 font-small flex-1" type="span.name"></span>
        </div>

        <span class="font-small m-l-a m-r-08" type="span.time">left</span>

        <div class="progress-wrap m-0 m-r-08">
                <!-- circular progress -->
            <div class="c-progress" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
                <svg viewBox="0 0 120 120" class="c-progress__svg">
                    <circle class="c-progress__track" cx="60" cy="60" r="54"></circle>
                    <circle class="c-progress__bar"   cx="60" cy="60" r="54"></circle>
                </svg>
            </div>

            <!-- hover replacement icon -->
            <div class="c-progress__icon" type="icon.stop">
                <i class="fa-light fa-circle-xmark" aria-hidden="true"></i>
            </div>
        </div>
    </div>
</template>

<!--Force password reset modal-->
<template id="forcePasswordResetModal">
    <div class="w-100 h-100 p-absolute d-flex p-absolute top-0 left-0 modal-index">
        <div class="w-100p h-100p p-absolute top-0 left-0 z-index--1 backgrond-blur-1" type="modal.background"></div>
        <div class="container-1 w-30 h-fit m-a p-2 d-flex flex-column">
            <h3 class="p-0 m-0 m-b-1">Password reset</h3>
            <span class="font-note font-small">Please change your password.</span>

            <span class="m-t-2 font-small font-note">New password</span>
            <div class="input-field-1 w-100p m-t-1">
                <input type="password" class="selectable" typeI="input.password">
            </div>

            <span class="m-t-2 font-small font-note">Confirm password</span>
            <div class="input-field-1 w-100p m-t-1">
                <input type="password" class="selectable" typeI="input.passwordConfirm">
            </div>

            <div class="d-flex m-t-2">
                <span class="m-l-a button-2 p-lr-3" type="button.cancel">Cancel</span>
                <span class="m-l-1 button-4 p-lr-3" type="button.confirm">Save</span>
            </div>
        </div>
    </div>
</template>


<script src="/code/utils/alert.js"></script>
<script src="/code/utils/format.js"></script>
<script src="/code/utils/param.js"></script>
<script src="/code/utils/user.js"></script>
<script src="/code/utils/lazySearch.js"></script>
<script src="/code/utils/dragndrop.js"></script>
<script src="/code/utils/contextMenu.js"></script>
<script src="/code/utils/tooltip.js"></script>
<script src="/code/utils/tabsync.js"></script>
<script src="/code/utils/cirlceProgress.js"></script>

<script src="/code/classes/file.js"></script>
<script src="/code/classes/folder.js"></script>

<script src="/code/controllers/modals/rename.js"></script>
<script src="/code/controllers/modals/share.js"></script>
<script src="/code/controllers/modals/trash.js"></script>
<script src="/code/controllers/modals/folder.js"></script>
<script src="/code/controllers/modals/forcePasswordReset.js"></script>
<script src="/code/controllers/modal.js"></script>
<script src="/code/controllers/file.js"></script>
<script src="/code/controllers/folder.js"></script>
<script src="/code/controllers/view.js"></script>
<script src="/code/controllers/share.js"></script>
<script src="/code/controllers/storage.js"></script>
<script src="/code/controllers/security.js"></script>


</html>